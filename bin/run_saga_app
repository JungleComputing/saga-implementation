#!/bin/sh

if [ -z "$SAGA_HOME" ] ; then
    echo SAGA_HOME variable not set, using $PWD
    SAGA_HOME=$PWD
fi

if [ -z "$SAGA_ADAPTORS_HOME" ] ; then
    echo SAGA_ADAPTORS_HOME variable not set, using $PWD
    SAGA_ADAPTORS_HOME=$PWD
fi

# ---- do not touch anything below this line ----

SAGA_LIB_LOCATION=$SAGA_HOME/lib
GAT_LIB_LOCATION=$SAGA_ADAPTORS_HOME/lib/JavaGAT
SAGA_ADAPTOR_LOCATION=$SAGA_ADAPTORS_HOME/lib:$GAT_LIB_LOCATION
GAT_ADAPTOR_LOCATION=$GAT_LIB_LOCATION/adaptors

# Jar-files from library.
SAGA_CLASSPATH=""
add_to_saga_classpath () {
    JARFILES=`cd "$1" && ls *.jar 2>/dev/null`
    for i in ${JARFILES} ; do
	if [ -z "$SAGA_CLASSPATH" ] ; then
	    SAGA_CLASSPATH="$1/$i"
	else
	    SAGA_CLASSPATH="$SAGA_CLASSPATH:$1/$i"
	fi
    done
}

add_to_saga_classpath $SAGA_LIB_LOCATION

java -cp "$CLASSPATH:$SAGA_CLASSPATH" -Dlog4j.configuration=file:$SAGA_HOME/log4j.properties -Dsaga.adaptor.path=$SAGA_ADAPTOR_LOCATION -Dgat.adaptor.path=$GAT_ADAPTOR_LOCATION -Dsaga.factory=org.ogf.saga.impl.bootstrap.MetaFactory "$@"
